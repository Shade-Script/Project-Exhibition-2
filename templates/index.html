<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Scheduler</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="header">
        <img class="logo" src="{{ url_for('static', filename='white_logo_logo.jpeg') }}" alt="Logo">
    </div>

    <div class="background-image"></div>

    <div class="content">
        <h1>Weekly Scheduler</h1>
        {% if not timetable %}
            <form method="post" enctype="multipart/form-data" action="/upload">
                <label for="schedule_image">Upload Your Schedule Image:</label>
                <input type="file" id="schedule_image" name="schedule_image" accept="image/*" required>
                <br><br>
               <!-- Display Options Form -->
                    <div>
                        <label>Display Options:</label>
                        <input type="checkbox" name="display_options" value="course_code" {% if 'course_code' in selected_options %}checked{% endif %}> Course Code
                        <input type="checkbox" name="display_options" value="course_name" {% if 'course_name' in selected_options %}checked{% endif %}> Course Name
                        <input type="checkbox" name="display_options" value="faculty_name" {% if 'faculty_name' in selected_options %}checked{% endif %}> Faculty Name
                        <input type="checkbox" name="display_options" value="venue" {% if 'venue' in selected_options %}checked{% endif %}> Venue
                    </div>
                <button type="submit">Upload</button>
            </form>
        {% endif %}

        {% if timetable %}
        <!-- Timetable Display -->
        <div class="results">
            <h2>Extracted Timetable:</h2>
            <form method="post" action="/submit_timetable">
                <table border="1">
                    <thead>
                        <tr>
                            <th>Day / Time</th>
                            {% set first_day = time_slots.keys() | first %}
                            {% for slot_id, slot_info in time_slots[first_day].items() %}
                                <th>{{ slot_info.start }} - {{ slot_info.end }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        {% for day, slots in time_slots.items() %}
                            <tr>
                                <td>{{ day }}</td>
                                {% for slot_id, slot_info in slots.items() %}
                                    <td>
                                        <textarea name="timetable_data[{{day}}][{{slot_id}}]">
                                            {% for info in timetable[day][slot_id] %}
                                                {{ info | join(", ") | trim }}
                                            {% endfor %}
                                        </textarea>
                                    </td>
                                {% endfor %}
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <button type="submit">Submit Changes</button>
            </form>
        </div>
    {% endif %}

        {% if error_message %}
        <div class="error">
            <p>{{ error_message }}</p>
        </div>
        {% endif %}
    </div>
</body>
</html>